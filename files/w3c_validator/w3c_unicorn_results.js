var W3C={start:function(){W3C.cleanHash();W3C.ContextsToShow=7;W3C.Observers=$$(".observer");$$("input#lang_change").setStyle("display","none");W3C.LanguagesForm=$("lang_choice");W3C.LanguagesForm.addEvent("change",function(L){window.location="./"+W3C.LanguagesForm.getProperty("action")+"?"+this.toQueryString()+window.location.hash});var G=500;var A=$$(".observer.invalid");var E=new Fx.Scroll(document);var I=new Fx.Scroll(document,{duration:0});$$(".section").each(function(N){var P=N.getElement(".title");var O=N.getElement(".block");if(!N.hasClass("observer")||N.getElement(".section")!=null){P.addClass("pointer");var M=new Element("span",{"class":"arrow"});var L;if(P.getElement("span.icons")!=null){L=P.getElement("span.icons")}else{L=P.getElement("a.anchor")}M.inject(L,"after")}N.store("fxSlide",new Fx.Slide(O,{duration:G,link:"cancel"}));N.store("block",O);P.addEvent("click",function(Q){W3C.toggle(N)})});$$(".observer .section").each(function(L){if(L.hasClass("warnings")){W3C.close(L,false)}else{W3C.open(L,false)}});$$(".observer .title a").each(function(L){L.addEvent("click",function(M){M.stopPropagation()})});$$(".observer").each(function(L){W3C.open(L,false);if(L.hasClass("valid")&&A.length>0){W3C.close(L,false)}L.getElement("a.anchor").addEvent("click",function(M){W3C.open(L,true)});if(!L.hasClass("grouped")){if(L.getElement("a.infos")){L.getElement("a.infos").addEvent("click",function(M){M.preventDefault();W3C.open(L,true);W3C.closeAllSectionsBut(L,L.getElement("div.infos"),true);E.toElement(L)})}if(L.getElement("a.errors")){L.getElement("a.errors").addEvent("click",function(M){M.preventDefault();W3C.open(L,true);W3C.closeAllSectionsBut(L,L.getElement("div.errors"),true);E.toElement(L)})}if(L.getElement("a.warnings")){L.getElement("a.warnings").addEvent("click",function(M){M.preventDefault();W3C.open(L,true);W3C.closeAllSectionsBut(L,L.getElement("div.warnings"),true);E.toElement(L)})}}});$$("div#messages pre").slide("hide");$$("div#messages > div").each(function(L){if(L.getElement("pre")){L.addClass("pointer");L.addEvent("click",function(M){L.getElement("pre").slide("toggle")})}});var D=new Fx.SmoothScroll({links:".smooth",wheelStops:true});if(window.location.hash=="#collapsed"){$$(".observer").each(function(L){W3C.close(L,false)})}W3C.parseHash();var C=$("observations").getProperty("class");var J=new RegExp(/contextShow:'[^']*'/);var B=J.exec(C);var K="";for(i=0;i<B.length;i++){K=K+B[i]}var F=K.replace("contextShow:","").replace(/'/g,"");var J=new RegExp(/contextHide:'[^']*'/);var B=J.exec(C);var K="";for(i=0;i<B.length;i++){K=K+B[i]}var H=K.replace("contextHide:","").replace(/'/g,"");$$("td.message").each(function(L){if(L.getProperty("rowspan")>W3C.ContextsToShow){var M=L.getParent("tr");var S=M.getElement("td.anchor");var T=L.getProperty("rowspan");var N=1;var R=M;var Q=new Array();var P=0;while(N<=T){if(N>W3C.ContextsToShow){R.setStyle("display","none");Q[P]=R;P++}if(N==T){var U=new Element("tr",{"class":"showContext"});var O=new Element("td",{colspan:"3"});O.addClass("pointer");O.setProperty("title",F.replace(/%1/,Q.length));O.set("text",F.replace(/%1/,Q.length));O.inject(U);U.inject(R,"after");U.addEvent("click",function(V){var W=Q.some(function(X){if(X.getStyle("display")=="none"){return true}else{return false}});if(W){Q.each(function(X){X.setStyle("display","")});L.setProperty("rowspan",T+1);S.setProperty("rowspan",T+1);O.setProperty("title",H);O.set("text",H);I.toElement(M)}else{Q.each(function(X){X.setStyle("display","none")});L.setProperty("rowspan",W3C.ContextsToShow+1);S.setProperty("rowspan",W3C.ContextsToShow+1);O.setProperty("title",F.replace(/%1/,Q.length));O.set("text",F.replace(/%1/,Q.length));I.toElement(M)}})}R=R.getNext("tr");N++}L.setProperty("rowspan",W3C.ContextsToShow+1);S.setProperty("rowspan",W3C.ContextsToShow+1)}})},toggle:function(B){var C=B.getElement(".title");var A=B.retrieve("fxSlide");if(B.retrieve("open")){W3C.close(B,true)}else{W3C.open(B,true)}},close:function(B,E){var D=B.retrieve("open");var C=B.getElement(".title");var A=B.retrieve("fxSlide");C.removeClass("toggled");B.store("open",false);if(E&&D){A.slideOut().chain(function(){B.getElement("div").setStyle("display","none");A.callChain()})}else{A.hide();B.getElement("div").setStyle("display","none")}},open:function(C,E){var B=!C.retrieve("open");var D=C.getElement(".title");var A=C.retrieve("fxSlide");D.addClass("toggled");C.store("open",true);C.getElement("div").setStyle("display","");if(E&&B){A.slideIn().chain(function(){C.getElement("div").setStyle("height","auto");A.callChain()})}else{A.show();C.getElement("div").setStyle("height","auto")}},closeAllObserversBut:function(A,B){W3C.Observers.each(function(C){if(C!=A){W3C.close(C,B)}});W3C.open(A,B)},closeAllSectionsBut:function(A,B,C){A.getElements(".section").each(function(D){if(D!=B){W3C.close(D,C)}});W3C.open(B,C)},parseHash:function(){var E=window.location.hash;if(E==""||E=="#collapsed"){return }var B=E.replace("#","").split("_");var J=B[0];var M=B[1];var A=B[2];var I=B[3];var F=new Fx.Scroll(document,{duration:0});var G=W3C.Observers.getProperty("id").indexOf(J);if(G==-1){W3C.setHash("");return }var H=W3C.Observers[G];W3C.open(H,false);if(!M){F.toElement(H);return }var K=H.getElements(".section").getProperty("id").indexOf(J+"_"+M);if(K==-1){W3C.setHash(J);return }var L=H.getElements(".section")[K];W3C.closeAllSectionsBut(H,L,false);if(!A){F.toElement(H);return }var D=L.getElements("td.uri").getProperty("id").indexOf(J+"_"+M+"_"+A);if(D==-1){W3C.setHash(J+"_"+M);return }var C=L.getElements("td.uri")[D];if(!I){F.toElement(C);return }W3C.setHash(E.replace("#",""))},updateHash:function(){var C=W3C.Forms[W3C.SelectedTab].getProperty("id");var B="+task_"+W3C.TaskOptions[W3C.SelectedTask].getProperty("value");var A=W3C.WithOptions?"+with_options":"";W3C.setHash(C+B+A)},cleanHash:function(){var A=window.location.hash;if(A.match("^#validate-by")){W3C.setHash("")}},setHash:function(A){if(window.webkit419){W3C.FakeForm=W3C.FakeForm||new Element("form",{method:"get"}).injectInside(document.body);W3C.FakeForm.setProperty("action","#"+A).submit()}else{window.location.replace("#"+A)}}};window.addEvent("domready",W3C.start);
